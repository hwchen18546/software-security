b my_getline
r
r <<< `python -c 'print "\x02" + "aaaa"*1000'`
disassemble 
x %esp+18
x %esp+0x18
x $esp+0x18
x/x $esp+0x18
x/x $esp+0x18
b *0x0809e131
c
x/x $esp+0x18
ni
x/x $esp+0x18
ni
x/x $esp+0x18
r <<< `python -c 'print "\xff"'`
c
ni
x/x $esp+0x18
ni
x/x $esp+0x18
r <<< `python -c 'print "\xff\xff\xff\xff"'`
c
x/x $esp+0x18
ni
x/x $esp+0x18
r <<< `python -c 'print "\x0a\xff\xff\xff"'`
c
ni
c
b *0x0809e131
r
b *0x0809e131
r
ni
cv
clear
r
ni
ni
r
b *0x0809e131
r
ni
x/x $esp+0x18
ni
x/x $esp+0x18
ni
r <<< `python -c 'print "\377"'`
ni
x/x $esp+0x18
ni
x/x $esp+0x18
c
ni
ni
disassemble 
b *0x0809e152
r
ni
r
mi
ni
ni
r <<< `python -c 'print "\xff"'`
c
r
ni
r
disassemble 
ni
disassemble 
b *0x0809e131
b *0x0809e152
r
ni
ni
c
ni
ni
r
b main
r
x $esp+0xcc
x\w $esp+0xcc
x/x $esp+0xcc
x/w $esp+0xcc
x/s $esp+0xcc
x/100x $esp
x/100w $esp
x/100s $esp
b main
r
x/100s $esp
x/100c $esp
x/100cr $esp
r
x/200s $esp
disassemble 
b *0x0809e2b2
r
c
x/200s $esp
x/s 0xbffff2cc
b read_file
c
x/s 0xbffff2cc
x/200s $esp
x/s 0xbffff2cc
x/s 0xbffff218
x/10s 0xbffff218
x/100s 0xbffff218
r
c
c
x/s 0xbffff218
x/s 0xbffff27c
x/s 0xbffff218 + 61
/s 0xbffff218 + 61
x/s 0xbffff216
x/s 0xbffff217
x/s 0xbffff218
x/s 0xbffff218
x/s 0xbffff218 + a
x/s 0xbffff218 + 0x61
x/s 0xbffff218 + 0x61
x/s 0xbffff218 + 0x61
x/s 0xbffff218 + 0x60
x/s 0xbffff218 + 0x61
x/s 0xbffff218 + 0x62
x/s 0xbffff218 + 0x61
x 0xbffff2cc - 0xbffff218
r <<< `python -c 'print "../flag\x00" + "\xb4"*100'`
c

c
r <<< `python -c 'print "../flag\x00" + "\xb4"*100'`
